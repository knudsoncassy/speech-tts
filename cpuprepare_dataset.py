import os from pathlib import Path import pandas as pd DATA_DIR = Path(__file__).resolve().parent.parent / "data" WAV_DIR = DATA_DIR / "wavs" METADATA = DATA_DIR / "metadata.csv" def prepare_dataset(): if not METADATA.exists(): raise FileNotFoundError("Run transcribe.py first to generate metadata.csv") df = pd.read_csv(METADATA, sep="|", header=None, names=["file_name", "text"]) df["file_path"] = df["file_name"].apply(lambda x: str(WAV_DIR / f"{x}.wav")) df.to_csv(DATA_DIR / "metadata.csv", sep="|", index=False, header=False) print(f"[+] Dataset ready with {len(df)} samples") if __name__ == "__main__": prepare_dataset()
