import os import whisper import soundfile as sf from pathlib import Path DATA_DIR = Path(__file__).resolve().parent.parent / "data" WAV_DIR = DATA_DIR / "wavs" METADATA = DATA_DIR / "metadata.csv" model = whisper.load_model("large-v3") # loads Whisper model (use CUDA on V100) def transcribe_all(): with open(METADATA, "w", encoding="utf-8") as f: for wav_file in WAV_DIR.glob("*.wav"): print(f"[+] Transcribing {wav_file.name}") result = model.transcribe(str(wav_file)) text = result["text"].strip() f.write(f"{wav_file.stem}|{text}\n") if __name__ == "__main__": transcribe_all()
